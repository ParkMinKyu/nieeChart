<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="jquery-1.8.3.min.js"></script>
<script type="text/javascript">
var canvas;
var ctx;
$(function(){
	$('#createBtn').click(function(){
		var rows = parseInt($('#rows').val());
		var cols = parseInt($('#cols').val());
		var width = cols*50;
		var height = rows*40;
		var ctab = width/cols;
		var cspace = parseInt(width/cols)/2;
		var rtab = 30*(rows+1);
		var rspace = (height-rtab)/2;
		var cAraay = new Array();
		var rAraay = new Array();

		canvas = document.getElementById("canvas");
		canvas.width = width;
		canvas.height = height;
		ctx = canvas.getContext("2d");
		ctx.font="15px Arial";
		ctx.clearRect(0,0,canvas.width,canvas.height)

		for(var i = 1 ; i <= cols ; i ++){
			var startX = ((i*ctab)-cspace);
			var startY = rspace;
			var endX = ((i*ctab)-cspace);
			var endY = rtab;

			ctx.beginPath();
			ctx.moveTo(startX,startY);
			ctx.fillText(i,startX,startY);
			ctx.lineTo(endX,(startY+endY));
			ctx.fillText(i,endX,(startY+endY));
			ctx.stroke();

			var colObj = {
					startX : startX, 
					startY : startY, 
					endX : endX, 
					endY : (startY+endY),
					rtab : 30,
					ctab : ctab
			}

			cAraay.push(colObj);
		}

		var command = '';
		while(command != 'x'){
			//command = prompt("사다리 정보를 입력하세요(x는 입력 완료).","");
			command = '1 1';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);
			command = '6 1';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);
			command = '9 1';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);
			command = '3 2';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);
			command = '5 2';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '8 2';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '4 3';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '7 3';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '10 3';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '2 4';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '6 4';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '8 4';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '3 5';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '5 5';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = '7 5';
			var idx = command.split(' ');
			var nowObj = cAraay[parseInt(idx[1])-1];
			var nextObj = cAraay[parseInt(idx[1])];

			ctx.beginPath();
			ctx.moveTo(nowObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.lineTo(nextObj.startX,(nowObj.startY)+(parseInt(idx[0])*nowObj.rtab));
			ctx.stroke();

			var rowObj = {
					startX : nowObj.startX, 
					startY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab), 
					endX : nextObj.startX, 
					endY : (nowObj.startY)+(parseInt(idx[0])*nowObj.rtab),
					rtab : 30,
					ctab : ctab
			}
			rAraay.push(rowObj);

			command = 'x';
		}

		var userInput = '';
		while(userInput != 'x'){
			userInput = prompt("사다리 게임을 시작할 출발 지점을 입력하세요(x는 입력 완료).","");
			var isExit = false;
			while(!isExit){
				var nowObj = cAraay[parseInt(userInput)-1];
				var startY = nowObj.startY;
				var endY = startY + nowObj.endY;
				var pos = parseInt(userInput)-1;
				var moveX = nowObj.startX ;
				var moveY = nowObj.startY ;
				var lineX = 0 ;
				var lineY = 0 ;
				var color1 = '#';
				for(var j = 0 ; j < 6 ; j ++){
					color1 += parseInt(Math.random()*(15)).toString(16);
				}
				ctx.strokeStyle = color1;
				while(startY < endY){
					for(var i = 0 ; i < rAraay.length ; i++){
						if(startY == rAraay[i].startY && nowObj.startX == rAraay[i].startX){
							if(nowObj.startX < rAraay[i].endX){
								ctx.beginPath();
								moveX = moveX == 0 ? nowObj.startX : moveX;
								moveY = moveY ==0 ?  nowObj.startY : moveY;
								lineX = nowObj.startX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								lineX = rAraay[i].endX;
								lineY = rAraay[i].endY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								ctx.stroke();
								
								pos++;
								nowObj = cAraay[pos];
								console.log(pos);
							}else if(nowObj.startX > rAraay[i].endX){
								ctx.beginPath();
								moveX = moveX == 0 ? nowObj.startX : moveX;
								moveY = moveY ==0 ?  nowObj.startY : moveY;
								lineX = nowObj.startX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								lineX = rAraay[i].endX;
								lineY = rAraay[i].endY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								ctx.stroke();
								pos--;
								nowObj = cAraay[pos];
								console.log(pos);
							}
						}else if(startY == rAraay[i].startY && nowObj.endX == rAraay[i].endX){
							if(nowObj.endX < rAraay[i].startX){
								ctx.beginPath();
								moveX = moveX == 0 ? nowObj.endX : moveX;
								moveY = moveY ==0 ?  nowObj.startY : moveY;
								lineX = nowObj.endX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								lineX = rAraay[i].startX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								ctx.stroke();
								pos++;
								nowObj = cAraay[pos];
								console.log(pos);
							}else if(nowObj.endX > rAraay[i].startX){
								ctx.beginPath();
								moveX = moveX == 0 ? nowObj.endX : moveX;
								moveY = moveY ==0 ?  nowObj.startY : moveY;
								lineX = nowObj.endX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								lineX = rAraay[i].startX;
								lineY = rAraay[i].startY;
								ctx.moveTo(moveX,moveY);
								ctx.lineTo(lineX,lineY);
								moveX = lineX;
								moveY = lineY;
								ctx.stroke();
								pos--;
								nowObj = cAraay[pos];
								console.log(pos);
							}
						}
					}
					isExit = true;
					startY++;
				}
				ctx.beginPath();
				lineX = nowObj.endX;
				lineY = nowObj.endY;
				ctx.moveTo(moveX,moveY);
				ctx.lineTo(lineX,lineY);
				ctx.stroke();
				alert((pos +1 ) + "번 당첨 입니다.");
			}
		}

	});
});
</script>
</head>
<body>
	높이는 몇 ? <input type="number" id="rows" value="10">
	참여자는 몇명? <input type="number" id="cols" value="6"><button id="createBtn">사다리 생성</button>
	<br>
	<canvas id="canvas" style="border: 1px solid;"></canvas>
</body>
</html>
